@model Umuomaku.Data.Models.Highlight

@{
    ViewData["Title"] = "Update Highlight";
}

<partial name="_MetaHead" />

<div class="container mt-5">
    <h3 class="text-center mb-4">Update Highlight</h3>

    <div id="successAlert" class="alert alert-success d-none" role="alert"></div>

    <form asp-action="UpdateHighlights" asp-controller="Admin" enctype="multipart/form-data" method="post" onsubmit="return validateHighlightForm()">
        <input type="hidden" asp-for="Id" />
        
        <div class="mb-3">
            <label asp-for="Title" class="form-label fw-bold"></label>
            <input asp-for="Title" class="form-control" />
            <span asp-validation-for="Title" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label class="form-label fw-bold">Replace Image (optional)</label>
            <input type="file" name="ImageFile" class="form-control" />
            @if (!string.IsNullOrEmpty(Model.ImageUrl))
            {
                <div class="mt-2">
                    <img src="~/uploads/@Url.Content(Model.ImageUrl)" width="200" alt="Current Image" class="img-thumbnail" />
                </div>
            }
        </div>

        <div class="mb-3">
            <label asp-for="Content" class="form-label fw-bold"></label>
            <textarea asp-for="Content" class="form-control" rows="6"></textarea>
            <span asp-validation-for="Content" class="text-danger"></span>
        </div>

        <button type="submit" class="btn btn-success w-100">Update Highlight</button>
    </form>
</div>

<br />
<br />


@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        function validateHighlightForm() {
            const title = document.querySelector('input[name="Title"]').value.trim();
            const content = document.querySelector('textarea[name="Content"]').value.trim();

            if (!title || !content) {
                alert("Title and Content are required.");
                return false;
            }

            return true;
        }

        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('success') === 'true') {
            const alertBox = document.getElementById('successAlert');
            alertBox.textContent = 'Highlight updated successfully!';
            alertBox.classList.remove('d-none');
        }
    </script>
}
